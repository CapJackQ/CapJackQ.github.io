<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=" rel="stylesheet" type="text/css" />



  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=">


  <link rel="mask-icon" href="/images/logo.svg?v=" color="#222">














<meta name="description" content="Classes同其它面向对象编程语言一样, Objective-C的类为创建对象提供了蓝图. 首先, 在一个类中定义了属性(properties)和行为(behaviors)的集合. 然后, 从该类中实例化对象与属性和行为交互.      Objective-C同C++类似, 将类的接口从实现中抽离出来. 接口(int">
<meta property="og:type" content="article">
<meta property="og:title" content="Objective-C Classes">
<meta property="og:url" content="http://yoursite.com/2016/05/17/Objective-C-Classes/index.html">
<meta property="og:site_name" content="Hello | Totoro">
<meta property="og:description" content="Classes同其它面向对象编程语言一样, Objective-C的类为创建对象提供了蓝图. 首先, 在一个类中定义了属性(properties)和行为(behaviors)的集合. 然后, 从该类中实例化对象与属性和行为交互.      Objective-C同C++类似, 将类的接口从实现中抽离出来. 接口(interface)声明了类的公用的属性和方法, 与之对应的实现(implementa">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://n0whkq-bn1306.files.1drv.com/y3mrkpr4vaiXN_pxud5fJ9zLC53xP-_0PVBbmJaIxJsXfQJQXF5wDHKmFQFDJNpPbcT-amtJPntGOtC1HWi2c_GZad4D5aQIMvM-G4ebakyVnGRcBtSFYftOwSCT10ULJ1_Lc6YC4KH-UiqjiNpE1a3FLyY5JRs4FHnmF-HU6H1D6g?width=1028&height=498&cropmode=none">
<meta property="og:image" content="https://n0yinq-bn1306.files.1drv.com/y3mNYFpcvHpODq8rbMA7w0bS6-xmnqAS560o3j6NJ5T9krR2T0PBLAYVxSt9fLZl7i9SAypbXJUqYj5JfzrGJUdpj0xEGnUwoABd_6v3ZzLsuW-REG7DHFWuY8w_21GOYGGnWwhH_Oa-Xc7SVdZ9PKgghds0M7faRy31MNrRghwgi8?width=744&height=630&cropmode=none">
<meta property="og:image" content="https://n0zrpw-bn1306.files.1drv.com/y3mNgROg246lQTOXLloOu7ugwiYEd3nSMLrEI7yLehwBu_74tATTZ3AZ3J6Oz_iy_V5dJVvnjYh_pGIb9FS4O1yKb6bfHl1FkGAbvRV8FOU5vYLffh4ZEX1FQXvynzhb0y5Bbdb30Xyagq_JBIlOBTGunrw05KUCfHvk845QUInmb8?width=690&height=316&cropmode=none">
<meta property="og:updated_time" content="2018-08-14T12:56:00.955Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Objective-C Classes">
<meta name="twitter:description" content="Classes同其它面向对象编程语言一样, Objective-C的类为创建对象提供了蓝图. 首先, 在一个类中定义了属性(properties)和行为(behaviors)的集合. 然后, 从该类中实例化对象与属性和行为交互.      Objective-C同C++类似, 将类的接口从实现中抽离出来. 接口(interface)声明了类的公用的属性和方法, 与之对应的实现(implementa">
<meta name="twitter:image" content="https://n0whkq-bn1306.files.1drv.com/y3mrkpr4vaiXN_pxud5fJ9zLC53xP-_0PVBbmJaIxJsXfQJQXF5wDHKmFQFDJNpPbcT-amtJPntGOtC1HWi2c_GZad4D5aQIMvM-G4ebakyVnGRcBtSFYftOwSCT10ULJ1_Lc6YC4KH-UiqjiNpE1a3FLyY5JRs4FHnmF-HU6H1D6g?width=1028&height=498&cropmode=none">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2016/05/17/Objective-C-Classes/"/>





  <title>Objective-C Classes | Hello | Totoro</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hello | Totoro</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/05/17/Objective-C-Classes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Totorooo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hello | Totoro">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Objective-C Classes</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-05-17T19:03:07+08:00">
                2016-05-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="Classes"><a href="#Classes" class="headerlink" title="Classes"></a>Classes</h2><p>同其它面向对象编程语言一样, Objective-C的类为创建对象提供了蓝图. 首先, 在一个类中定义了属性(properties)和行为(behaviors)的集合. 然后, 从该类中实例化对象与属性和行为交互.     </p>
<p>Objective-C同C++类似, 将类的接口从实现中抽离出来. 接口(<strong>interface</strong>)声明了类的公用的属性和方法, 与之对应的实现(<strong>implementation</strong>)则定义了这些属性和方法的实现代码. 这与之前提到的<a href="">函数</a>的定义与实现分离是相同的.</p>
<p><img src="https://n0whkq-bn1306.files.1drv.com/y3mrkpr4vaiXN_pxud5fJ9zLC53xP-_0PVBbmJaIxJsXfQJQXF5wDHKmFQFDJNpPbcT-amtJPntGOtC1HWi2c_GZad4D5aQIMvM-G4ebakyVnGRcBtSFYftOwSCT10ULJ1_Lc6YC4KH-UiqjiNpE1a3FLyY5JRs4FHnmF-HU6H1D6g?width=1028&height=498&cropmode=none" width="600"> <div align="center"> 类的接口和实现 </div><br><a id="more"></a></p>
<p>这一部分, 将要探究类的接口, 实现, 属性和方法, 以及用规范的方式来实例化对象. 同时将会介绍一些Objective-C的内省(introspection)和反射(reflection)的机制.</p>
<h3 id="Creating-Classes"><a href="#Creating-Classes" class="headerlink" title="Creating Classes"></a>Creating Classes</h3><p>我们将以<code>Car</code>做为类名, 其接口部分在文件<code>Car.h</code>(也称为头文件)中, 实现部分在<code>Car.m</code>文件. 这些是Objective-C类的标准的文件扩展名. 类的头文件可以在其他类与之交互时使用, 而实现文件只能有编译器使用. </p>
<p>Xcode 为创建一个新的类提供了便捷的模板. 通过_File_&gt;_New_&gt;_File_…或是_Cmd+N_来创建<code>Car</code>类. 为模板选择_iOS_&gt;_Cocoa Touch_类目. 此后, 会出现一些配置选项:<br><img src="https://n0yinq-bn1306.files.1drv.com/y3mNYFpcvHpODq8rbMA7w0bS6-xmnqAS560o3j6NJ5T9krR2T0PBLAYVxSt9fLZl7i9SAypbXJUqYj5JfzrGJUdpj0xEGnUwoABd_6v3ZzLsuW-REG7DHFWuY8w_21GOYGGnWwhH_Oa-Xc7SVdZ9PKgghds0M7faRy31MNrRghwgi8?width=744&height=630&cropmode=none" width="500"></p>
<div align="center">创建Car类</div>     

<p>使用_Class_一栏填入<code>Car</code>, _Subclass_一栏填入<code>NSObject</code>. <a href="https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/index.html" target="_blank" rel="noopener">NSObject</a>是Objective-C的基类(top-level), 其他的所有类都继承与它. 点击_Next_会提示选择文件保存路径. 将其保存在项目目录文件下. 在提示框底部确保工程文件在_Targets_的部分选中, 这才是真正将类添加到编译资源中.</p>
<p><img src="https://n0zrpw-bn1306.files.1drv.com/y3mNgROg246lQTOXLloOu7ugwiYEd3nSMLrEI7yLehwBu_74tATTZ3AZ3J6Oz_iy_V5dJVvnjYh_pGIb9FS4O1yKb6bfHl1FkGAbvRV8FOU5vYLffh4ZEX1FQXvynzhb0y5Bbdb30Xyagq_JBIlOBTGunrw05KUCfHvk845QUInmb8?width=690&height=316&cropmode=none" width="400"></p>
<div align="center">将类添加到Target</div>

<h3 id="Interfaces"><a href="#Interfaces" class="headerlink" title="Interfaces"></a>Interfaces</h3><p><code>Car.h</code>文件包含了一些模板代码, 但是我们会使用以下的代码. 声明了一个名为<code>model</code>的属性和方法<code>drive</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// Car.h</span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line"></span><br><span class="line">@interface Car : NSObject &#123;</span><br><span class="line">    // Protected instance variables (not recommended)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@property (copy) NSString *model;</span><br><span class="line"></span><br><span class="line">- (void)drive;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>接口部分由<code>@interface</code>指令创建, 随后是本类名和父类名, 之间由<code>,</code>隔开. 受保护的变量可以在花括号(<code>{}</code>)内定义, 但是更多的开发者将实例变量(instance variables)看做是实现部分的细节, 更愿意在<code>.m</code>文件中存储而不是在接口部分.</p>
<p><code>@property</code>指令声明了一个公共的属性, copy语义定义了它的内存管理行为. 这种情况下, 分配给模型的值被存储为副本而不是直接指针. 在<a href="http://rypress.com/tutorials/objective-c/properties" target="_blank" rel="noopener">Properties</a>部分讲述了更多的细节. 接下来便是属性数据类型和名字, 和普通变量声明差不多.</p>
<p><code>- (void)drive</code>行声明了一个叫做<code>drive</code>无参的方法, <code>(void)</code>部分定了它的返回值类型. 减号(<strong>-</strong>)表示该方法为实例方法(_instance_ method)(相对应的为类方法<a href="http://rypress.com/tutorials/objective-c/classes#class-methods-and-variables" target="_blank" rel="noopener">_class_ method</a>).</p>
<h3 id="Implementations"><a href="#Implementations" class="headerlink" title="Implementations"></a>Implementations</h3><p>任何类实现时需要做的第一件事就是将其对应的借口文件引入. <code>@implementation</code>命令同<code>@interface</code>类似, 除了不需要包含父类. 私有的实例变量能够在类名之后的花括号之间存储:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// Car.m</span><br><span class="line">#import &quot;Car.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation Car &#123;</span><br><span class="line">    // Private instance variables</span><br><span class="line">    double _odometer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@synthesize model = _model;    // Optional for Xcode 4.4+</span><br><span class="line"></span><br><span class="line">- (void)drive &#123;</span><br><span class="line">    NSLog(@&quot;Driving a %@. Vrooooom!&quot;, self.model);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p><code>@synthesize</code>是用来为属性自动合成访问方法(accessor method)的便捷指令. 默认地, 访问器(getter)简单地以属性名命名(<code>model</code>), 设置器则是以<code>set</code>作为其前缀命名(<code>setModel</code>). 这样比手动地为每个属性创建访问器更简便. 合成语句<code>_model</code>部分定义了私有实例变量名用于属性. </p>
<p>使用<code>@property</code>来声明属性会自动合成, 因此如果漏掉<code>@synthesize</code>使用默认的实例变量名是没有问题的. </p>
<p>方法<code>drive</code>的实现同接口的签名相同, 但是当方法被调用时不论方法内部是怎样的代码都会被执行. 注意该方法中我们是通过<code>self.model</code>访问而非<code>_model</code>实例变量的形式. 由于它利用了属性的<a href="">存取方法</a>, 因此这是一个最实践的方法. 一般, 只有在<a href="">初始化方法</a>和<a href="">dealloc</a>方法中才直接使用访问实例变量的方法.</p>
<p><code>self</code>关键词引用实例调用方法(如同C++和Java中的<code>this</code>一样). 除了访问属性之外, 它还可以调用同一类中定义的其他方法(e.g., [<code>self anotherMethod</code>]). </p>
<h3 id="Instantiation-and-Usage"><a href="#Instantiation-and-Usage" class="headerlink" title="Instantiation and Usage"></a>Instantiation and Usage</h3><p>任何需要访问一个类的文件都必须一如该类的头文件(<code>Car.h</code>)—永远无法直接访问实现文件. 这使得要将公共API和其底层实现分离的目标落空. 因此, 要看到<code>Car</code>类的行为, 如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// main.m</span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line">#import &quot;Car.h&quot;</span><br><span class="line"></span><br><span class="line">int main(int argc, const char * argv[]) &#123;</span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        Car *toyota = [[Car alloc] init];</span><br><span class="line">        </span><br><span class="line">        [toyota setModel:@&quot;Toyota Corolla&quot;];</span><br><span class="line">        NSLog(@&quot;Created a %@&quot;, [toyota model]);</span><br><span class="line">        </span><br><span class="line">        toyota.model = @&quot;Toyota Camry&quot;;</span><br><span class="line">        NSLog(@&quot;Changed the car to a %@&quot;, toyota.model);</span><br><span class="line">        </span><br><span class="line">        [toyota drive];</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在接口文件引入<code>#import</code>指令之后, 就可以使用<code>alloc/init</code>模式来实例化对象. 实例化是一个两步的过程: 首先必须通过调用<code>alloc</code>方法给对象分配一些内存空间, 然后再初始化以备用. 永远无法使用未经初始化的对象.</p>
<p>再次重复, 所有的对象必须以指针存储, 所以才使用<code>Car *toyota</code>而不是<code>Car toyota</code>来声明变量. </p>
<p>Objective-C的对象要调用方法, 将实例和方法用方括号括起来, 之间用空格隔开. 参数在方法名之后传入, 其前面由冒号分开. 如果你熟知C++, Java或者Python, <code>[toyota setModel:@&quot;Toyota Corolla&quot;]</code>方法和下面方法调用是一样的:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">toyota.setModel(&quot;Toyota Corolla&quot;);</span><br></pre></td></tr></table></figure>
<p>这种方括号的语法对于刚接触该语言的人员来说并不适应. 在阅读<a href="http://rypress.com/tutorials/objective-c/methods" target="_blank" rel="noopener">Methods</a>之后, 你会更适应它.</p>
<p>这个例子也向你展示了两种访问对象属性的方法. 你可以使用合成的<code>model</code>和<code>setModel</code>存取方法, 或者也可以使用便利的点语法(dot-syntax), 后者对于使用过类似语言的人来说更为熟悉.</p>
<h2 id="Class-Methods-and-Variables"><a href="#Class-Methods-and-Variables" class="headerlink" title="Class Methods and Variables"></a>Class Methods and Variables</h2><p>上面例子定义了实例级别的属性和方法, 但是有时候可能会用到类级别的属性和方法. 通常在其他编程语言(不要与关键词static混淆)中称之为”static”方法/属性.</p>
<p>类方法的声明除了前缀使用”+”之外, 其他部分和实例方法类似. 让我们为<code>Car.h</code>添加一个类方法:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// Car.h</span><br><span class="line">+ (void)setDefaultModel:(NSString *)aModel;</span><br></pre></td></tr></table></figure>
<p>类似地, 类方法的_实现_同样以”+”为前缀. 然而, 严格来说Objective-C中是没有类级别(class-level)的变量, 不过你可以通过在实现之前声明一个静态变量来模仿它:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// Car.m</span><br><span class="line">#import &quot;Car.h&quot;</span><br><span class="line"></span><br><span class="line">static NSString *_defaultModel; // class-level</span><br><span class="line"></span><br><span class="line">@implementation Car &#123;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">+ (void)setDefaultModel:(NSString *)aModel &#123;</span><br><span class="line">    _defaultModel = [aModel copy];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p><code>[aModel copy]</code>复制了一个参数的副本而不是直接给它赋值. </p>
<p>类方法同样使用方括号语法, 但是必须是类来直接调用方法. 实例_无法_调用类方法(<code>[toyota setDefaultModel:@&quot;Model T&quot;]</code>会抛出错误).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// main.m</span><br><span class="line">[Car setDefaultModel:@&quot;Nissan Versa&quot;];</span><br></pre></td></tr></table></figure>
<h2 id="“Constructor”-Methods"><a href="#“Constructor”-Methods" class="headerlink" title="“Constructor” Methods"></a>“Constructor” Methods</h2><p>Objective-C中并没有构造方法. 相反, 对象是通过分配内存后立即调用<code>init</code>方法来进行初始化. 这就是为什么实例化总是一个两步的过程: 先分配内存, 然后初始化. </p>
<p><code>init</code>是Objective-C默认的初始化方法, 但是你也可以自定义初始化方法并且配置一些参数. 自定义初始化方法并无特别之处, 除了方法名必须常以<code>init</code>起头. 一个构造方法的例子如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// Car.h</span><br><span class="line">- (id)initWithModel:(NSString *)aModel;</span><br></pre></td></tr></table></figure>
<p>实现该方法时, 你必须按照以下初始化<code>initWithModel:</code>方法的模式来实现. <code>super</code>关键词代指父类, <code>self</code>则是指调用该方法的实例. 为<code>Car.m</code>添加方法.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// Car.m</span><br><span class="line">- (id)initWithModel:(Nsstring *)aModel &#123;</span><br><span class="line">	self = [super init];</span><br><span class="line">	if(self) &#123;</span><br><span class="line">		// any custom setup work goes here</span><br><span class="line">		_model = [aModel copy];</span><br><span class="line">		_odometer = 0;</span><br><span class="line">	&#125;</span><br><span class="line">	return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (id)init &#123;</span><br><span class="line">	// forward to the &quot;designated&quot; initialization method</span><br><span class="line">	return [self initWithModel:_defaultModel];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>初始化方法应该总是返回对象本身, 如果对象本身无法被初始化, 就会返回空(<code>nil</code>). 所以在使用<code>self</code>之前需要检查下它存不存在. 一般只需要一个初始化方法这样做即可, 其他的则称之为<strong>指定初始化**</strong>(designated initializer)**. 这样当有数个自定义<code>初始化</code>方法的时候排除了样板代码. </p>
<p>同时注意, 是如何在<code>initWithModel:</code>方法中给实例变量<code>_model</code>和<code>_odometer</code>直接分配值. 记住, 这是唯一一处应该这样做的方法, 其他的方法中应该使用<code>self.model</code>和<code>self.odometer</code>.</p>
<h3 id="Class-Level-Initialization"><a href="#Class-Level-Initialization" class="headerlink" title="Class-Level Initialization"></a>Class-Level Initialization</h3><p><code>初始化</code>方法和<code>init</code>同样属于类级别的方法. 它允许在任何人使用之前设置类. 比如, 可以使用这种方法为<code>_defaultModel</code>变量赋一个可用的值:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// Car.m</span><br><span class="line">+ (void)initialize &#123;</span><br><span class="line">	if (self == [Car class]) &#123;</span><br><span class="line">		// makes sure this isn&apos;t executed more than once</span><br><span class="line">		_defaultModel = @&quot;Nissan Versa&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>初始化</code>类方法会在每个类使用之前调用一次, 这包括了所有<code>Car</code>的子类, 这意味着如果<code>Car</code>类的子类中没有重新实现它, 那么该类会有两个初始化调用. 结果是, 很好地实践了<code>self == [Car class]</code>条件以确保初始化代码仅运行一次. 同样注意, 在类方法中, <code>self</code>关键词指代类自身而非实例.</p>
<p>Objective-C不会强制你标记方法为重写(overrides). 尽管<code>init</code>和<code>initialize</code>都由他们的父类定义, <code>NSObject</code>, 但是当你在`Car.m中重写它们的时候编译器不会抱错.</p>
<p><code>main.n</code>函数下一次迭代显示了我们自定义的初始化方法. 在类初次使用之前, <code>[Car initialize]</code>自动调用, 设置<code>_defaultModel</code>的值为<code>@&quot;Nissan Versa&quot;</code>. 这在第一个<code>NSLog()</code>函数中可以看出来, 同时也可以在第二个打印输出结果中看到自定义初始化方法(<code>initWithModel:</code>).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// main.m</span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line">#import &quot;Car.h&quot;</span><br><span class="line"></span><br><span class="line">int main(int argc, const char * argv[]) &#123;</span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        </span><br><span class="line">        // Instantiating objects</span><br><span class="line">        Car *nissan = [[Car alloc] init];</span><br><span class="line">        NSLog(@&quot;Created a %@&quot;, [nissan model]);</span><br><span class="line">        </span><br><span class="line">        Car *chevy = [[Car alloc] initWithModel:@&quot;Chevy Corvette&quot;];</span><br><span class="line">        NSLog(@&quot;Created a %@, too.&quot;, chevy.model);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Dynamic-Typing"><a href="#Dynamic-Typing" class="headerlink" title="Dynamic Typing"></a>Dynamic Typing</h2><p>类本身也相当于对象, 这使得它对自己的属性提出疑问成为可能(introspection, 内省), 或者甚至即时(on-the-fly)改变它们的行为. 这是动态类型非常强大的能力, 因为这样可以让你在不知道对象是什么类型的前提下调用对象方法或者设置对象的属性. </p>
<p>获取类对象最简单的方法是通过<code>class</code>类级别方法. 比如, <code>[Car class]</code>返回一个<code>Car</code>类的对象. 可以通过将该对象传递给<code>isMemberOfClass:</code>和<code>isKindOfClass:</code>方法, 来获取关于其他实例的信息. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">// main.m</span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line">#import &quot;Car.h&quot;</span><br><span class="line"></span><br><span class="line">int main(int argc, cost char * argv[]) &#123;</span><br><span class="line">	@autoreleasepool &#123;</span><br><span class="line">		Car *delorean = [[Car alloc] initWithModel:@&quot;DeLorean&quot;];</span><br><span class="line">		</span><br><span class="line">		// get the class of an object</span><br><span class="line">		NSLog(@&quot;%@ is an instance of the %@ class&quot;, [delorean model], [delorean class]);</span><br><span class="line">		</span><br><span class="line">		// check an object against a class and all subclass</span><br><span class="line">		if ([delorean isKindOfClass:[NSObject class]]) &#123;</span><br><span class="line">			NSLog(@&quot;%@ is an instance of NSObject or one of its subclasses&quot;, [delorean  model]);</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			NSLog(@&quot;%@ is not an instance of NSObject or one of its subclasses&quot;, [delorean model]);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		// Check an object against a class, but not its subclasses</span><br><span class="line">        if ([delorean isMemberOfClass:[NSObject class]]) &#123;</span><br><span class="line">            NSLog(@&quot;%@ is a instance of NSObject&quot;,</span><br><span class="line">                  [delorean model]);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            NSLog(@&quot;%@ is not an instance of NSObject&quot;,</span><br><span class="line">                  [delorean model]);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        // Convert between strings and classes</span><br><span class="line">        if (NSClassFromString(@&quot;Car&quot;) == [Car class]) &#123;</span><br><span class="line">            NSLog(@&quot;I can convert between strings and classes!&quot;);</span><br><span class="line">        &#125;	</span><br><span class="line">	&#125;</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/05/11/Objective-C-Functions/" rel="next" title="Objective-C学习Functions">
                <i class="fa fa-chevron-left"></i> Objective-C学习Functions
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/06/01/Objective-C-Properties/" rel="prev" title="Objective-C Properties">
                Objective-C Properties <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Totorooo</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Classes"><span class="nav-number">1.</span> <span class="nav-text">Classes</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Creating-Classes"><span class="nav-number">1.1.</span> <span class="nav-text">Creating Classes</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Interfaces"><span class="nav-number">1.2.</span> <span class="nav-text">Interfaces</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementations"><span class="nav-number">1.3.</span> <span class="nav-text">Implementations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Instantiation-and-Usage"><span class="nav-number">1.4.</span> <span class="nav-text">Instantiation and Usage</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Class-Methods-and-Variables"><span class="nav-number">2.</span> <span class="nav-text">Class Methods and Variables</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#“Constructor”-Methods"><span class="nav-number">3.</span> <span class="nav-text">“Constructor” Methods</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Class-Level-Initialization"><span class="nav-number">3.1.</span> <span class="nav-text">Class-Level Initialization</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dynamic-Typing"><span class="nav-number">4.</span> <span class="nav-text">Dynamic Typing</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Totorooo</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  








  
  





  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/canvas_sphere.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v="></script>

  <script type="text/javascript" src="/js/src/motion.js?v="></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v="></script>
<script type="text/javascript" src="/js/src/post-details.js?v="></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v="></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->



  


  




	





  





  












  





  

  

  

  
  

  
  


  

  

</body>
</html>
